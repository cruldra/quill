---
title: 剪贴板模块
---

剪贴板处理 Quill 与外部应用程序之间的复制、剪切和粘贴。存在一组默认值以提供对粘贴内容的合理解释,并能够通过匹配器进行进一步自定义。

剪贴板通过以[后序](https://en.wikipedia.org/wiki/Tree_traversal#Post-order)遍历相应的 DOM 树来解释粘贴的 HTML,构建所有子树的 [Delta](/docs/delta/) 表示。在每个后代节点处,使用 DOM 节点和到目前为止的 Delta 解释调用匹配器函数,允许匹配器返回修改后的 Delta 解释。

为了有效地使用匹配器,必须熟悉和掌握 [Deltas](/docs/delta/)。


## API

#### addMatcher

向剪贴板添加自定义匹配器。使用 `nodeType` 的匹配器首先按添加顺序调用,然后是使用 CSS `selector` 的匹配器,也按添加顺序调用。[`nodeType`](https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType) 可以是 `Node.ELEMENT_NODE` 或 `Node.TEXT_NODE`。

**方法**

```javascript
addMatcher(selector: String, (node: Node, delta: Delta) => Delta)
addMatcher(nodeType: Number, (node: Node, delta: Delta) => Delta)
```

**示例**

```javascript
quill.clipboard.addMatcher(Node.TEXT_NODE, (node, delta) => {
  return new Delta().insert(node.data);
});

// 将 <b> 标签解释为粗体
quill.clipboard.addMatcher('B', (node, delta) => {
  return delta.compose(new Delta().retain(delta.length(), { bold: true }));
});
```

### dangerouslyPasteHTML

在给定索引处将 HTML 片段表示的内容插入编辑器。该片段由剪贴板[匹配器](#addMatcher)解释,可能不会产生完全相同的输入 HTML。如果未提供插入索引,则整个编辑器内容将被覆盖。[source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。

不当处理 HTML 可能导致[跨站脚本攻击 (XSS)](https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)),并且未能正确清理既容易出错又是 Web 漏洞的主要原因。此方法遵循 React 的示例,并恰当地命名以确保开发人员已采取必要的预防措施。

**方法**

```javascript
dangerouslyPasteHTML(html: String, source: String = 'api')
dangerouslyPasteHTML(index: Number, html: String, source: String = 'api')
```

**示例**

```javascript
quill.setText('Hello!');

quill.clipboard.dangerouslyPasteHTML(5, '&nbsp;<b>World</b>');
// 编辑器现在是 '<p>Hello&nbsp;<strong>World</strong>!</p>';
```


## 配置

### matchers

可以将匹配器数组传递到剪贴板的配置选项中。这些将附加在 Quill 自己的默认匹配器之后。

```javascript
const quill = new Quill('#editor', {
  modules: {
    clipboard: {
      matchers: [
        ['B', customMatcherA],
        [Node.TEXT_NODE, customMatcherB]
      ]
    }
  }
});
```

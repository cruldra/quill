---
title: API
---

<div className="table-of-contents">
  {data.api.map(({ hashes, title }) => (
    <nav key={title}>
      <h4 anchor="off">{title}</h4>
      <ul>
        {hashes.map(hash => (
          <li key={hash}>
            <a href={`#${hash.toLowerCase()}`}>
              {hash.replace('-experimental', '')}
            </a>
          </li>
        ))}
      </ul>
    </nav>
  ))}
</div>

## 内容

### deleteText

从编辑器中删除文本,返回表示更改的 [Delta](/docs/delta/)。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。当编辑器被[禁用](#disable)时,`source` 为 `"user"` 的调用将被忽略。

**方法**

```typescript
deleteText(index: number, length: number, source: string = 'api'): Delta
```

**示例 1**

```typescript
quill.deleteText(6, 4);
```

**示例 2**

<SandpackWithQuillTemplate
  beforeEditor={`
<button id="deleteButton">Delete Text</button>

<hr/>
  `}
  content={`
<p>Hello, World!</p>
  `}
  files={{
    'index.js': `
const quill = new Quill('#editor', { theme: 'snow' });

document.querySelector('#deleteButton').addEventListener('click', () => {
  quill.deleteText(5, 7);
});
    `
  }}
/>

### getContents

检索编辑器的内容及格式数据,以 [Delta](/docs/delta/) 对象表示。

**方法**

```typescript
getContents(index: number = 0, length: number = remaining): Delta
```

**示例**

```typescript
const delta = quill.getContents();
```

### getLength

检索编辑器内容的长度。请注意,即使 Quill 为空,仍然有一个由 '\n' 表示的空行,因此 `getLength` 将返回 1。

**方法**

```typescript
getLength(): number
```

**示例**

```typescript
const length = quill.getLength();
```

### getText

检索编辑器的字符串内容。非字符串内容将被省略,因此返回的字符串长度可能比 [`getLength`](#getlength) 返回的编辑器长度短。请注意,即使 Quill 为空,编辑器中仍然有一个空行,因此在这些情况下 `getText` 将返回 '\n'。

`length` 参数默认为剩余文档的长度。

**方法**

```typescript
getText(index: number = 0, length: number = remaining): string
```

**示例**

```typescript
const text = quill.getText(0, 10);
```

### getSemanticHTML

获取编辑器内容的 HTML 表示。
此方法对于以可在其他应用程序中使用的格式导出编辑器内容很有用。

`length` 参数默认为剩余文档的长度。

**方法**

```typescript
getSemanticHTML(index: number = 0, length: number = remaining): string
```

**示例**

```typescript
const html = quill.getSemanticHTML(0, 10);
```

### insertEmbed

将嵌入内容插入编辑器,返回表示更改的 [Delta](/docs/delta/)。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。当编辑器被[禁用](#disable)时,`source` 为 `"user"` 的调用将被忽略。

**方法**

```typescript
insertEmbed(index: number, type: string, value: any, source: string = 'api'): Delta
```

**示例**

```typescript
quill.insertEmbed(10, 'image', 'https://quilljs.com/images/cloud.png');
```

### insertText

将文本插入编辑器,可选择指定格式或多个[格式](/docs/formats/)。返回表示更改的 [Delta](/docs/delta/)。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。当编辑器被[禁用](#disable)时,`source` 为 `"user"` 的调用将被忽略。

**方法**

```typescript
insertText(index: number, text: string, source: string = 'api'): Delta
insertText(index: number, text: string, format: string, value: any,
           source: string = 'api'): Delta
insertText(index: number, text: string, formats: { [name: string]: any },
           source: string = 'api'): Delta
```

**示例**

```typescript
quill.insertText(0, 'Hello', 'bold', true);

quill.insertText(5, 'Quill', {
  color: '#ffff00',
  italic: true,
});
```

### setContents

用给定的内容覆盖编辑器。内容应以[换行符](/docs/delta/#line-formatting)结尾。返回表示更改的 Delta。如果给定的 Delta 没有无效操作,这将与传入的 Delta 相同。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。当编辑器被[禁用](#disable)时,`source` 为 `"user"` 的调用将被忽略。

**方法**

```typescript
setContents(delta: Delta, source: string = 'api'): Delta
```

**示例**

```typescript
quill.setContents([
  { insert: 'Hello ' },
  { insert: 'World!', attributes: { bold: true } },
  { insert: '\n' },
]);
```

### setText

用给定的文本设置编辑器的内容,返回表示更改的 [Delta](/docs/delta/)。请注意,Quill 文档必须以换行符结尾,因此如果省略,将为你添加一个。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。当编辑器被[禁用](#disable)时,`source` 为 `"user"` 的调用将被忽略。

**方法**

```typescript
setText(text: string, source: string = 'api'): Delta
```

**示例**

```typescript
quill.setText('Hello\n');
```

### updateContents

将 Delta 应用于编辑器内容,返回表示更改的 [Delta](/docs/delta/)。如果传入的 Delta 没有无效操作,这些 Deltas 将相同。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。当编辑器被[禁用](#disable)时,`source` 为 `"user"` 的调用将被忽略。

**方法**

```typescript
updateContents(delta: Delta, source: string = 'api'): Delta
```

**示例**

```typescript
// 假设编辑器当前包含 [{ insert: 'Hello World!' }]
quill.updateContents(new Delta()
  .retain(6)                  // 保留 'Hello '
  .delete(5)                  // 删除 'World'
  .insert('Quill')
  .retain(1, { bold: true })  // 将感叹号设为粗体
);
// 编辑器现在应该是 [
//  { insert: 'Hello Quill' },
//  { insert: '!', attributes: { bold: true} }
// ]
```

<Hint>
此方法从开头更新内容,而不是从当前选择开始。
使用 `Delta#retain(length: number)` 跳过你希望保持不变的内容。
</Hint>

## 格式化

### format

格式化用户当前选择的文本,返回表示更改的 [Delta](/docs/delta/)。如果用户的选择长度为 0,即它是一个光标,则格式将被设置为活动状态,因此用户键入的下一个字符将具有该格式。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。当编辑器被[禁用](#disable)时,`source` 为 `"user"` 的调用将被忽略。

**方法**

```typescript
format(name: string, value: any, source: string = 'api'): Delta
```

**示例**

```typescript
quill.format('color', 'red');
quill.format('align', 'right');
```

### formatLine

格式化给定范围内的所有行,返回表示更改的 [Delta](/docs/delta/)。有关可用格式的列表,请参阅[格式](/docs/formats/)。使用内联格式调用时无效。要删除格式,请为 value 参数传递 `false`。用户的选择可能不会被保留。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。当编辑器被[禁用](#disable)时,`source` 为 `"user"` 的调用将被忽略。

**方法**

```typescript
formatLine(index: number, length: number, source: string = 'api'): Delta
formatLine(index: number, length: number, format: string, value: any,
           source: string = 'api'): Delta
formatLine(index: number, length: number, formats: { [name: string]: any },
           source: string = 'api'): Delta
```

**示例**

```typescript
quill.setText('Hello\nWorld!\n');

quill.formatLine(1, 2, 'align', 'right');   // 右对齐第一行
quill.formatLine(4, 4, 'align', 'center');  // 居中对齐两行
```

### formatText

格式化编辑器中的文本,返回表示更改的 [Delta](/docs/delta/)。对于行级格式(如文本对齐),请针对换行符或使用 [`formatLine`](#formatline) 辅助方法。有关可用格式的列表,请参阅[格式](/docs/formats/)。要删除格式,请为 value 参数传递 `false`。用户的选择可能不会被保留。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。当编辑器被[禁用](#disable)时,`source` 为 `"user"` 的调用将被忽略。

**方法**

```typescript
formatText(index: number, length: number, source: string = 'api'): Delta
formatText(index: number, length: number, format: string, value: any,
           source: string = 'api'): Delta
formatText(index: number, length: number, formats: { [name: string]: any },
           source: string = 'api'): Delta
```

**示例**

```typescript
quill.setText('Hello\nWorld!\n');

quill.formatText(0, 5, 'bold', true);      // 将 'hello' 设为粗体

quill.formatText(0, 5, {                   // 取消 'hello' 的粗体并将其颜色设置为蓝色
  'bold': false,
  'color': 'rgb(0, 0, 255)'
});

quill.formatText(5, 1, 'align', 'right');  // 右对齐 'hello' 行
```

### getFormat

检索给定范围内文本的通用格式。要报告格式,范围内的所有文本都必须具有真值。如果有不同的真值,将报告包含所有真值的数组。如果未提供范围,则使用用户的当前选择范围。可用于显示在光标上设置了哪些格式。如果不带参数调用,将使用用户的当前选择范围。

**方法**

```typescript
getFormat(range: Range = current): Record<string, unknown>
getFormat(index: number, length: number = 0): Record<string, unknown>
```

**示例**

```typescript
quill.setText('Hello World!');
quill.formatText(0, 2, 'bold', true);
quill.formatText(1, 2, 'italic', true);
quill.getFormat(0, 2);   // { bold: true }
quill.getFormat(1, 1);   // { bold: true, italic: true }

quill.formatText(0, 2, 'color', 'red');
quill.formatText(2, 1, 'color', 'blue');
quill.getFormat(0, 3);   // { color: ['red', 'blue'] }

quill.setSelection(3);
quill.getFormat();       // { italic: true, color: 'blue' }

quill.format('strike', true);
quill.getFormat();       // { italic: true, color: 'blue', strike: true }

quill.formatLine(0, 1, 'align', 'right');
quill.getFormat();       // { italic: true, color: 'blue', strike: true,
                         //   align: 'right' }
```

### removeFormat

删除给定范围内的所有格式和嵌入内容,返回表示更改的 [Delta](/docs/delta/)。如果范围包含行的任何部分,则将删除行格式。用户的选择可能不会被保留。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。当编辑器被[禁用](#disable)时,`source` 为 `"user"` 的调用将被忽略。

**方法**

```typescript
removeFormat(index: number, length: number, source: string = 'api'): Delta
```

**示例**

```typescript
quill.setContents([
  { insert: 'Hello', { bold: true } },
  { insert: '\n', { align: 'center' } },
  { insert: { formula: 'x^2' } },
  { insert: '\n', { align: 'center' } },
  { insert: 'World', { italic: true }},
  { insert: '\n', { align: 'center' } }
]);

quill.removeFormat(3, 7);
// 编辑器内容现在是
// [
//   { insert: 'Hel', { bold: true } },
//   { insert: 'lo\n\nWo' },
//   { insert: 'rld', { italic: true }},
//   { insert: '\n', { align: 'center' } }
// ]

```

## 选择

### getBounds

检索给定位置的选择的像素位置(相对于编辑器容器)和尺寸。用户的当前选择不必在该索引处。对于计算工具提示的放置位置很有用。

**方法**

```typescript
getBounds(index: number, length: number = 0):
  { left: number, top: number, height: number, width: number }
```

**示例**

```typescript
quill.setText('Hello\nWorld\n');
quill.getBounds(7); // 返回 { height: 15, width: 0, left: 27, top: 31 }
```

### getSelection

检索用户的选择范围,可选择首先聚焦编辑器。否则,如果编辑器没有焦点,可能会返回 `null`。

**方法**

```typescript
getSelection(focus = false): { index: number, length: number }
```

**示例**

```typescript
const range = quill.getSelection();
if (range) {
  if (range.length == 0) {
    console.log('用户光标位于索引', range.index);
  } else {
    const text = quill.getText(range.index, range.length);
    console.log('用户已高亮显示: ', text);
  }
} else {
  console.log('用户光标不在编辑器中');
}
```

### setSelection

将用户选择设置为给定范围,这也将聚焦编辑器。提供 `null` 作为选择范围将使编辑器失焦。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。

**方法**

```typescript
setSelection(index: number, length: number = 0, source: string = 'api')
setSelection(range: { index: number, length: number },
             source: string = 'api')
```

**示例**

```typescript
quill.setSelection(0, 5);
```


### scrollSelectionIntoView

将当前选择滚动到可见区域。
如果选择已经可见,则不会发生滚动。

<Hint>
当调用 [setSelection](#setselection) 时,Quill 会自动调用此方法,除非 source 是 `"silent"`。
</Hint>

**方法**

```typescript
scrollSelectionIntoView();
```

**示例**

```typescript
quill.scrollSelectionIntoView();
```


## 编辑器

### blur

从编辑器移除焦点。

**方法**

```typescript
blur();
```

**示例**

```typescript
quill.blur();
```

### disable

[`enable(false)`](#enable) 的简写。

### enable

设置用户通过鼠标或键盘等输入设备进行编辑的能力。当 `source` 为 `"api"` 或 `"silent"` 时,不影响 API 调用的功能。

**方法**

```typescript
enable(enabled: boolean = true);
```

**示例**

```typescript
quill.enable();
quill.enable(false);   // 禁用用户输入
```

### focus

聚焦编辑器并恢复其最后的范围。

**方法**

```typescript
focus(options: { preventScroll?: boolean } = {});
```

**示例**

```typescript
// 聚焦编辑器,并将选择滚动到视图中
quill.focus();

// 聚焦编辑器,但不滚动
quill.focus({ preventScroll: true });
```

### hasFocus

检查编辑器是否有焦点。请注意,工具栏、工具提示上的焦点不算作编辑器。

**方法**

```typescript
hasFocus(): boolean
```

**示例**

```typescript
quill.hasFocus();
```

### update

同步检查编辑器的用户更新,如果发生了更改,则触发事件。对于需要最新状态的协作用例中的冲突解决很有用。[Source](/docs/api/#events) 可以是 `"user"`、`"api"` 或 `"silent"`。

**方法**

```typescript
update(((source: string) = 'user'));
```

**示例**

```typescript
quill.update();
```

### scrollRectIntoView #experimental

将编辑器滚动到给定的像素位置。
[`scrollSelectionIntoView`](#scrollselectionintoview) 通过使用当前选择的边界调用此方法来实现。

```typescript
scrollRectIntoView(bounds: {
  top: number;
  right: number;
  bottom: number;
  left: number;
});
```

**示例 1**

```typescript
// 滚动编辑器以显示范围 { index: 20, length: 5 }
const bounds = this.selection.getBounds(20, 5);
if (bounds) {
  quill.scrollRectIntoView(bounds);
}
```

**示例 2**

<SandpackWithQuillTemplate
  files={{
    'index.js': `
let text = "";
for (let i = 0; i < 100; i += 1) {
  text += \`line \${i + 1}\\n\`;
}

const quill = new Quill('#editor', { theme: 'snow' });
quill.setText(text);

const target = 'line 50';
const bounds = quill.selection.getBounds(
  text.indexOf(target),
  target.length
);
if (bounds) {
  quill.scrollRectIntoView(bounds);
}
    `
  }}
/>

## 事件

### text-change

当 Quill 的内容发生更改时触发。提供更改的详细信息、更改前编辑器内容的表示以及更改的来源。如果源自用户,则 source 将为 `"user"`。例如:

- 用户在编辑器中输入
- 用户使用工具栏格式化文本
- 用户使用热键撤消
- 用户使用操作系统拼写更正

更改可能通过 API 发生,但只要它们源自用户,提供的 source 仍应为 `"user"`。例如,当用户单击工具栏时,从技术上讲,工具栏模块调用 Quill API 来实现更改。但 source 仍然是 `"user"`,因为更改的来源是用户的点击。

导致文本更改的 API 也可以使用 `"silent"` source 调用,在这种情况下不会触发 `text-change`。不建议这样做,因为它可能会破坏撤消堆栈和依赖于完整文本更改记录的其他功能。

对文本的更改可能会导致选择的更改(例如,输入会推进光标),但是在 `text-change` 处理程序期间,选择尚未更新,原生浏览器行为可能会将其置于不一致的状态。使用 [`selection-change`](#selection-change) 或 [`editor-change`](#editor-change) 进行可靠的选择更新。

**回调签名**

```typescript
handler(delta: Delta, oldContents: Delta, source: string)
```

**示例**

```typescript
quill.on('text-change', (delta, oldDelta, source) => {
  if (source == 'api') {
    console.log('API 调用触发了此更改。');
  } else if (source == 'user') {
    console.log('用户操作触发了此更改。');
  }
});
```

### selection-change

当用户或 API 导致选择更改时触发,范围表示选择边界。null 范围表示选择丢失(通常由编辑器失去焦点引起)。你还可以通过检查发出的范围是否为 null 来将此事件用作焦点更改事件。

导致选择更改的 API 也可以使用 `"silent"` source 调用,在这种情况下不会触发 `selection-change`。如果 `selection-change` 是副作用,这很有用。例如,输入会导致选择更改,但在每个字符上也发出 `selection-change` 事件会非常嘈杂。

**回调签名**

```typescript
handler(range: { index: number, length: number },
        oldRange: { index: number, length: number },
        source: string)
```

**示例**

```typescript
quill.on('selection-change', (range, oldRange, source) => {
  if (range) {
    if (range.length == 0) {
      console.log('用户光标位于', range.index);
    } else {
      const text = quill.getText(range.index, range.length);
      console.log('用户已高亮显示', text);
    }
  } else {
    console.log('光标不在编辑器中');
  }
});
```

### editor-change

当 `text-change` 或 `selection-change` 将被触发时触发,即使 source 是 `"silent"`。第一个参数是事件名称,`text-change` 或 `selection-change`,后跟通常传递给这些相应处理程序的参数。

**回调签名**

```typescript
handler(name: string, ...args)
```

**示例**

```typescript
quill.on('editor-change', (eventName, ...args) => {
  if (eventName === 'text-change') {
    // args[0] 将是 delta
  } else if (eventName === 'selection-change') {
    // args[0] 将是旧范围
  }
});
```

### on

添加事件处理程序。有关事件本身的更多详细信息,请参阅 [text-change](#text-change) 或 [selection-change](#selection-change)。

**方法**

```typescript
on(name: string, handler: Function): Quill
```

**示例**

```typescript
quill.on('text-change', () => {
  console.log('文本更改!');
});
```

### once

为事件的一次触发添加处理程序。有关事件本身的更多详细信息,请参阅 [text-change](#text-change) 或 [selection-change](#selection-change)。

**方法**

```typescript
once(name: string, handler: Function): Quill
```

**示例**

```typescript
quill.once('text-change', () => {
  console.log('第一次文本更改!');
});
```

### off

删除事件处理程序。

**方法**

```typescript
off(name: string, handler: Function): Quill
```

**示例**

```typescript
function handler() {
  console.log('你好!');
}

quill.on('text-change', handler);
quill.off('text-change', handler);
```

## 模型

### find

静态方法,返回给定 DOM 节点的 Quill 或 [Blot](https://github.com/quilljs/parchment) 实例。在后一种情况下,为 `bubble` 参数传递 true 将向上搜索给定 DOM 的祖先,直到找到相应的 [Blot](https://github.com/quilljs/parchment)。

**方法**

```typescript
Quill.find(domNode: Node, bubble: boolean = false): Blot | Quill
```

**示例**

```typescript
const container = document.querySelector('#container');
const quill = new Quill(container);
console.log(Quill.find(container) === quill); // 应该是 true

quill.insertText(0, 'Hello', 'link', 'https://world.com');
const linkNode = document.querySelector('#container a');
const linkBlot = Quill.find(linkNode);

// 从 blot 查找 Quill 实例
console.log(Quill.find(linkBlot.scroll.domNode.parentElement));
```

### getIndex

返回文档开头到给定 [Blot](https://github.com/quilljs/parchment) 出现位置之间的距离。

**方法**

```typescript
getIndex(blot: Blot): number
```

**示例**

```typescript
let [line, offset] = quill.getLine(10);
let index = quill.getIndex(line); // index + offset 应该 == 10
```

### getLeaf

返回文档中指定索引处的叶子 [Blot](https://github.com/quilljs/parchment)。

**方法**

```typescript
getLeaf(index: number): [LeafBlot | null, number]
```

**示例**

```typescript
quill.setText('Hello Good World!');
quill.formatText(6, 4, 'bold', true);

let [leaf, offset] = quill.getLeaf(7);
// leaf 应该是值为 "Good" 的 Text Blot
// offset 应该是 1,因为返回的叶子从索引 6 开始
```

### getLine

返回文档中指定索引处的行 [Blot](https://github.com/quilljs/parchment)。

**方法**

```typescript
getLine(index: number): [Block | BlockEmbed | null, number]
```

**示例**

```typescript
quill.setText('Hello\nWorld!');

let [line, offset] = quill.getLine(7);
// line 应该是表示第二行 "World!" 的 Block Blot
// offset 应该是 1,因为返回的行从索引 6 开始
```

### getLines

返回指定位置内包含的行。

**方法**

```typescript
getLines(index: number = 0, length: number = remaining): (Block | BlockEmbed)[]
getLines(range: Range): (Block | BlockEmbed)[]
```

**示例**

```typescript
quill.setText('Hello\nGood\nWorld!');
quill.formatLine(1, 1, 'list', 'bullet');

let lines = quill.getLines(2, 5);
// 包含 ListItem 和 Block Blot 的数组,
// 表示前两行
```

## 扩展

### debug

静态方法,在给定级别启用日志消息:`'error'`、`'warn'`、`'log'` 或 `'info'`。传递 `true` 等同于传递 `'log'`。传递 `false` 禁用所有消息。

**方法**

```typescript
Quill.debug(level: string | boolean)
```

**示例**

```typescript
Quill.debug('info');
```

### import

静态方法,返回 Quill 库、格式、模块或主题。通常,路径应该完全映射到 Quill 源代码目录结构。除非另有说明,否则修改返回的实体可能会破坏所需的 Quill 功能,强烈不建议这样做。

**方法**

```typescript
Quill.import(path): any
```

**示例**

```typescript
const Parchment = Quill.import('parchment');
const Delta = Quill.import('delta');

const Toolbar = Quill.import('modules/toolbar');
const Link = Quill.import('formats/link');
// 类似于 ES6 语法 `import Link from 'quill/formats/link';`
```

<Hint>
不要将此与 ECMAScript 模块的 [`import`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import) 关键字混淆。
`Quill.import()` 不会通过网络加载脚本,它只是从 Quill 库返回相应的模块,而不会产生任何副作用。
</Hint>

### register

注册模块、主题或格式,使它们可以添加到编辑器中。稍后可以使用 [`Quill.import`](/docs/api/#import) 检索。分别使用路径前缀 `'formats/'`、`'modules/'` 或 `'themes/'` 来注册格式、模块或主题。对于格式,有一个简写方式,只需直接传入格式,路径将自动生成。将覆盖具有相同路径的现有定义。

**方法**

```typescript
Quill.register(format: Attributor | BlotDefinintion, supressWarning: boolean = false)
Quill.register(path: string, def: any, supressWarning: boolean = false)
Quill.register(defs: { [path: string]: any }, supressWarning: boolean = false)
```

**示例**

```typescript
const Module = Quill.import('core/module');

class CustomModule extends Module {}

Quill.register('modules/custom-module', CustomModule);
```

```typescript
Quill.register({
  'formats/custom-format': CustomFormat,
  'modules/custom-module-a': CustomModuleA,
  'modules/custom-module-b': CustomModuleB,
});

Quill.register(CustomFormat);
// 你不能执行 Quill.register(CustomModuleA);因为 CustomModuleA 不是格式
```

### addContainer

在 Quill 容器内添加并返回一个容器元素,与编辑器本身同级。按照惯例,Quill 模块应该有一个以 `ql-` 为前缀的类名。可选择包含一个 refNode,容器应该在其之前插入。

**方法**

```typescript
addContainer(className: string, refNode?: Node): Element
addContainer(domNode: Node, refNode?: Node): Element
```

**示例**

```typescript
const container = quill.addContainer('ql-custom');
```

### getModule

检索已添加到编辑器的模块。

**方法**

```typescript
getModule(name: string): any
```

**示例**

```typescript
const toolbar = quill.getModule('toolbar');
```

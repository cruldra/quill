---
title: 自定义
---

Quill 在设计时就考虑了自定义和扩展。这是通过实现一个由细粒度、定义良好的 [API](/docs/api) 公开的小型编辑器核心来实现的。核心通过[模块](/docs/modules)进行增强,使用与你可以访问的相同的 [API](/docs/api)。

通常,常见的自定义在[配置](#configurations/)中处理,用户界面由[主题](#themes)和 CSS 处理,功能由[模块](#modules)处理,编辑器内容由 [Parchment](#content-and-formatting) 处理。

### 配置

Quill 倾向于代码优于配置&trade;,但对于非常常见的需求,特别是等效代码会很冗长或复杂的地方,Quill 提供了[配置](/docs/configuration/)选项。这将是一个很好的首选位置,用于确定你是否甚至需要实现任何自定义功能。

两个最强大的选项是 `modules` 和 `theme`。你可以通过简单地添加或删除单个[模块](/docs/modules/)或使用不同的[主题](/docs/themes/)来大幅改变或扩展 Quill 可以做什么和做什么。

### 主题

Quill 正式支持标准工具栏主题 [Snow](/docs/themes/#snow) 和浮动工具提示主题 [Bubble](/docs/themes/#bubble)。由于 Quill 不像许多传统编辑器那样被限制在 iframe 中,因此可以仅使用 CSS 进行许多视觉修改,使用现有主题之一。

如果你想大幅改变 UI 交互,可以省略 `theme` 配置选项,这将为你提供一个无样式的 Quill 编辑器。你仍然需要包含一个最小的样式表,例如,确保空格在所有浏览器中呈现,有序列表适当编号。

```html
<link rel="stylesheet" href="{{site.cdn}}/quill.core.css" />
```

从那里,你可以实现和附加自己的 UI 元素,如自定义下拉列表或工具提示。[使用 Parchment 克隆 Medium](/guides/cloning-medium-with-parchment/#final-polish) 的最后一节提供了一个实际示例。

### 模块

Quill 采用模块化架构设计,由一个小型编辑核心组成,周围是增强其功能的模块。其中一些功能对于编辑非常重要,例如管理撤消和重做的[历史](/docs/modules/history/)模块。因为所有模块都使用向开发人员公开的相同公共 [API](/docs/api),所以在必要时甚至可以互换核心模块。

与 Quill 的核心本身一样,许多[模块](/docs/modules/)公开了额外的配置选项和 API。在决定替换模块之前,请查看其文档。通常,你所需的自定义已经作为配置或 API 调用实现。

否则,如果你想大幅改变现有模块已经涵盖的功能,你可以简单地不包含它&mdash;或者当主题默认包含它时明确排除它&mdash;并使用默认模块使用的相同 [API](/docs/api) 在 Quill 外部实现你喜欢的功能。

<SandpackWithQuillTemplate
  files={{
    'index.js': `
const quill = new Quill('#editor', {
  modules: {
    toolbar: false    // Snow 默认包含工具栏
  },
  theme: 'snow'
});
`,
  }}
/>

一些模块&mdash;[剪贴板](/docs/modules/clipboard/)、[键盘](/docs/modules/keyboard/)和[历史](/docs/modules/history/)&mdash;需要包含,因为核心功能依赖于它们提供的 API。例如,尽管撤消和重做是基本的、预期的编辑器功能,但原生浏览器对此的行为处理是不一致和不可预测的。历史模块通过实现自己的撤消管理器并将 `undo()` 和 `redo()` 公开为 API 来弥合这一差距。

尽管如此,忠于 Quill 的模块化设计,你仍然可以通过实现自己的撤消管理器来替换历史模块,从而大幅改变撤消和重做&mdash;或任何其他核心功能&mdash;的工作方式。只要你实现相同的 API 接口,Quill 就会很乐意使用你的替换模块。这最容易通过继承现有模块并覆盖你想要更改的方法来完成。查看[模块](/docs/modules/)文档,了解覆盖核心[剪贴板](/docs/modules/clipboard/)模块的一个非常简单的示例。

最后,你可能想要添加现有模块未提供的功能。在这种情况下,将其组织为 Quill 模块可能很方便,[构建自定义模块](/guides/building-a-custom-module/)指南涵盖了这一点。当然,将此逻辑与 Quill 分开,放在你的应用程序代码中也是完全有效的。

### 内容和格式化

Quill 允许通过其文档模型 [Parchment](https://github.com/quilljs/parchment/) 修改和扩展它理解的内容和格式。内容和格式在 Parchment 中表示为 Blot 或 Attributor,它们大致对应于 DOM 中的节点或属性。

#### 类 vs 内联

Quill 在可能的情况下使用类,而不是内联样式属性,但两者都已实现供你选择。这方面的实时示例实现为 [Playground 代码片段](/playground/#class-vs-inline-style)。

```js
const ColorClass = Quill.import('attributors/class/color');
const SizeStyle = Quill.import('attributors/style/size');
Quill.register(ColorClass, true);
Quill.register(SizeStyle, true);

// 像往常一样初始化
const quill = new Quill('#editor', {
  modules: {
    toolbar: true,
  },
  theme: 'snow',
});
```

#### 自定义 Attributor

除了选择特定的 Attributor 之外,你还可以自定义现有的 Attributor。这是字体白名单的示例,用于添加其他字体。

```js
const FontAttributor = Quill.import('attributors/class/font');
FontAttributor.whitelist = [
  'sofia',
  'slabo',
  'roboto',
  'inconsolata',
  'ubuntu',
];
Quill.register(FontAttributor, true);
```

请注意,你仍然需要将这些类的样式添加到 CSS 文件中。

```html
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" />
<style>
  .ql-font-roboto {
    font-family: 'Roboto', sans-serif;
  }
</style>
```

#### 自定义 Blot

由 Blot 表示的格式也可以自定义。以下是如何更改用于表示粗体格式的 DOM 节点。

<SandpackWithQuillTemplate
  files={{
    'index.js': `
const Bold = Quill.import('formats/bold');
Bold.tagName = 'B';   // Quill 默认使用 <strong>
Quill.register(Bold, true);

// 像往常一样初始化
const quill = new Quill('#editor', {
  modules: {
    toolbar: true
  },
  theme: 'snow'
});

const Delta = Quill.import('delta');
quill.setContents(
  new Delta()
    .insert('Rendered with <b>!', { bold: true })
    .insert('\\n')
);
`
}}
/>

#### 扩展 Blot

你还可以扩展现有格式。这是一个不允许格式化其内容的列表项的快速 ES6 实现。代码块正是以这种方式实现的。

```js
const ListItem = Quill.import('formats/list/item');

class PlainListItem extends ListItem {
  formatAt(index, length, name, value) {
    if (name === 'list') {
      // 允许更改或删除列表格式
      super.formatAt(name, value);
    }
    // 否则忽略
  }
}

Quill.register(PlainListItem, true);

// 像往常一样初始化
const quill = new Quill('#editor', {
  modules: {
    toolbar: true,
  },
  theme: 'snow',
});
```

你可以通过调用 `console.log(Quill.imports);` 查看可用的 Blot 和 Attributor 列表。不支持直接修改此对象。请改用 [`Quill.register`](/docs/api/#register)。

有关 Parchment、Blot 和 Attributor 的完整参考,可以在 Parchment 自己的 [README](https://github.com/quilljs/parchment/) 中找到。有关深入的演练,请查看[使用 Parchment 克隆 Medium](/guides/cloning-medium-with-parchment/),它从 Quill 仅理解纯文本开始,到添加 [Medium](https://medium.com/) 支持的所有格式。大多数时候,你不必从头开始构建格式,因为大多数格式已经在 Quill 中实现,但了解 Quill 在这个更深层次上的工作方式仍然很有用。
